<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Page Title</title>
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="main.js"></script>
</head>
<body>
<h1><a href="/projects/json">Json</a></h1>
<div class="control">
    <input type="text" name="url" value="https://chaos.social/api/v1/instance" id="url">
    <button onclick="get_json()">Get JSON</button>
</div>
<div id="error"></div>
<pre id="json">
    <div id="wait" class="ripple hidden"><div></div><div></div></div>
</pre>
<script>
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    for(var k of urlParams.keys()) {
        if (k == "url") {
            document.getElementById('url').value = urlParams.get("url");
        }
    }
    const request_headers = new Headers();
    function get_json() {
        removeClass(document.getElementById('wait'), "hidden");
        var url = document.getElementById('url').value;
        fetch(
            url,
            {
                method: "GET",
                headers: request_headers,
            }
        ).then(response => {
            return response.json();
        }).then(data => {
            document.getElementById('json').innerHTML = syntaxHighlight(data);
        }).catch(err => {
            document.getElementById('error').innerHTML = err;
        });
    }
</script>
</body>
</html>